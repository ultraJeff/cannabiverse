extends ../layouts/default

include ../mixins/join-aside
include ../mixins/join-jumbotron
include ../mixins/post-card

//- block intro
//- 	.container
//- 		h1= data.category ? data.category.name : 'Blog'

block content
	.blog
		.container
			.row
				.col-lg-8
					aside.add-728.d-none.d-xl-block
					if data.category
						//-h2.mt-5.badge(class="badge-" + data.category.name.toLowerCase())= data.category.name
						h2.mt-5.badge.badge-research= data.category.name
					else
						h2.mt-5.badge.badge-research= 'Blog'

					if filters.category && !data.category
						h3.text-muted Invalid Category.
					else
						if data.posts.results.length
							//- if data.posts.totalPages > 1
							//- 	h4.text-weight-normal Showing
							//- 		strong #{data.posts.first}
							//- 		|  to
							//- 		strong #{data.posts.last}
							//- 		|  of
							//- 		strong #{data.posts.total}
							//- 		|  posts.
							//- else
							//- 	h4.text-weight-normal Showing #{utils.plural(data.posts.results.length, '* post')}.

							.post-wall
								.container-fluid
									.row
										.col
											+post-card(data.posts.results[0], 0)
									if data.posts.results.length > 1
										.row
											.col-lg-6
												+post-card(data.posts.results[1], 1)
												if data.posts.results.length > 2
													+post-card(data.posts.results[2], 2)

											if data.posts.results.length > 3
												.col-lg-6
													+post-card(data.posts.results[3], 3)
													if data.posts.results.length > 4
														+post-card(data.posts.results[4], 4)
									//- each post, index in data.posts.results
									//- 	+post-card(post, index)
									.row
										aside.add-728.d-none.d-xl-block

							if data.posts.totalPages > 1
								ul.pagination
									if data.posts.previous
										li: a(href='?page=' + data.posts.previous): span.fa.fa-angle-left
									else
										li.disabled: a(href='?page=' + 1): span.fa.fa-angle-left
									each p, i in data.posts.pages
										li(class=data.posts.currentPage == p ? 'active' : null)
											a(href='?page=' + (p == '...' ? (i ? data.posts.totalPages : 1) : p ))= p
									if data.posts.next
										li: a(href='?page=' + data.posts.next): span.fa.fa-angle-right
									else
										li.disabled: a(href='?page=' + data.posts.totalPages): span.entypo.fa.fa-angle-right
						else
							if data.category
								h3.text-muted There are no posts in the category #{data.category.name}.
							else
								h3.text-muted There are no posts yet.

				.col-lg-4
					+join-aside
					if data.categories.length
						.d-lg-block.d-none
							h2 Categories
							.list-group
								a(href='/blog', class=!data.category ? 'active' : false).list-group-item All Categories
								each cat in data.categories
									a(href='/blog/' + cat.key, class=data.category && data.category.id == cat.id ? 'active' : false).list-group-item= cat.name
					aside.add-300-short
					aside.add-300-tall

			+join-jumbotron
